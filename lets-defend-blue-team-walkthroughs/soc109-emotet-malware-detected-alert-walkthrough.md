# SOC109 - Emotet Malware Detected Alert

Hello, blue teamers and welcome to this blog entry, as I attempt to solve [Let’s Defend](https://letsdefend.io)’s SOC109 — Emotet Malware alert. It was fun to work with real-world malware and trace back its origins and characteristics.

Keep your investigation armor at the ready!

## Alert details

![](https://cdn-images-1.medium.com/max/1000/1\*XgS2p0b2hXMBxNFR3kztSA.png)

We are met with the following alert summary, which will prove beneficial as we keep investigating

Proceed to download the 349d13ca99ab03869548d75b99e5a1d0.zip file

Next steps:-

> Proceed to take ownership of the case\
> Create case

We receive the incident details, with all necessary information for our investigation

![](https://cdn-images-1.medium.com/max/1000/1\*kpfcJfmbxQQ43mhM0-wwxg.png)

Now, let’s start the playbook

## Detection of Threat Actor

![](https://cdn-images-1.medium.com/max/1000/1\*kUCe2TDE9fnws5iPZsSBag.png)

To detect the Threat Indicator, let’s first analyze the attached zip sample

Upon unzipping it, we get a file named ‘1word.doc’

It would be wise to open it on [Anyrun](https://any.run)

Two .exe files execute as we open it (namely powershell.exe and ntvdm.exe)

![](https://cdn-images-1.medium.com/max/1000/1\*BVbj\_JZdybf9GdH-oy3G8g.png)

What does the PowerShell file do?

Expanding the log to find more information, we get:-

![](https://cdn-images-1.medium.com/max/1000/1\*SF-g6pRWqN0k6UhlezzBag.png)

## Check if the malware is quarantined/cleaned

![](https://cdn-images-1.medium.com/max/1000/1\*Bo6NtYqBhQI0Mer13U8ApQ.png)

Go to the ‘Endpoint Security section and contain the victim host(RichardPRD)

![](https://cdn-images-1.medium.com/max/1000/1\*twSODZQynhjyCR35088jEQ.png)

> &#x20;A)Quarantined

## Analyze the Malware sample

![](https://cdn-images-1.medium.com/max/1000/1\*LIiqX2-lB2nel46sLwHY1Q.png)

> Q)Analyze malware in 3rd party tools and find C2 address

> You can use the free products/services below.

> AnyRun\
> VirusTotal\
> URLHouse\
> URLScan\
> HybridAnalysis

Let’s enumerate once more, using Anyrun tool

![](https://cdn-images-1.medium.com/max/1000/1\*SQ6RgKn8gy7zM7djIR3wvw.png)

The file is malicious

> A)Malicious

## Check If Someone Requested the C2 Server

![](https://cdn-images-1.medium.com/max/1000/1\*-RTISL2bHxhEc7pG5EdUog.png)

> Q)Please go to the “Log Management” page and check if the C2 address accessed. You can check if the malicious file is run by searching the C2 addresses of the malicious file.
>
> Please click “Yes” if someone access the malicious address. Otherwise please click “No” button.

![](https://cdn-images-1.medium.com/max/1000/1\*-RTISL2bHxhEc7pG5EdUog.png)

Searching ‘Log Management’, for the victim host, we get 7 connection log entries

![](https://cdn-images-1.medium.com/max/1000/1\*f\_6i3GhAzuTDOrUr51HYAQ.png)

We know for a fact that Emotet spreads via phishing emails, so it is wise to limit ourselves to ports 80 and 443 connection attempts

Keeping a note of these IP’s, let’s see the related IP Addresses that have been contacted from this malicious file(can be received from the ‘Relations’ tab under VirusTotal)

![](https://cdn-images-1.medium.com/max/1000/1\*ejj-X99yh0LNERDenNPIjw.png)

We can safely assume that the C2 Server was never accessed because none of the IP’s match with the ones found in the Log Management section

From my [research](https://www.sentinelone.com/blog/emotet-story-of-disposable-c2-servers/), I found that Emotet uses disposable C2 servers to propagate&#x20;

> A)Not accessed

![](https://cdn-images-1.medium.com/max/1000/1\*C\_Cb69wbYZGTy4U4RLORlQ.png)

## Add Artifacts

From Hybrid-Analysis, let’s note down outgoing traffic from this malicious file, to be added to our collection of artifacts

![](https://cdn-images-1.medium.com/max/1000/1\*w3G-CyjJ9z2aY2EOheeqPw.png)

Which finally boils down to:-

![](https://cdn-images-1.medium.com/max/1000/1\*1-VachJyqT4Us92WGV2LkA.png)

#### Analyst Note

We fill in the necessary details&#x20;

![](https://cdn-images-1.medium.com/max/1000/1\*8B2j9K9JURT\_qX1DIP2KpQ.png)

Finish playbook

## Alert Scorecard

![](https://cdn-images-1.medium.com/max/1000/1\*yi4dzJk-S2Mimdvy3iEOBw.png)

Not bad, not bad at all!

## Summary of Case

A phishing mail was sent from the source, disguised as a harmless document, which the receiver did not fall victim to.The attachment was responsibly analyzed and determined to have connections to the Emotet malware

The case was a true positive for a phishing attack and the analyst responsibly provided artifacts and notes, discussing the case characteristics and results

## Conclusion

Thank you for reading this blog entry. Stay tuned, as I go hunting some pcap files out there….

## Your opinion matters

My audience has a voice. Feel free to reach out to me, on my socials (links are on top of this page) for any queries to be addressed. Dropping a sweet message would make my day

Let your opinion about this write-up be known, by selecting any one of the emojis below!
